fixed the issue with adding the schedule with function using `schedule.add_hamiltonian()`.
added new unit tests to prevent this issue from happening again. 